<script>
const SITE={
  intro:{
    title:"Hey You üíñ",
    message:"Before we begin, I have something fun planned for you üòâ"
  },
  sections:[
    {
      title:"Funny üòÑ",
      bg:"linear-gradient(135deg,#ffe4f2,#fff)",
      intro:"Let‚Äôs start easy üòú",
      questions:["Funny Q1","Funny Q2","Funny Q3","Funny Q4"],
      yesImage:"Images/funny-yes.jpg",
      yesAudio:"Audio/funny-yes.mp3",
      noAudio:"Audio/funny-no.mp3"
    },
    {
      title:"Romantic üåπ",
      bg:"linear-gradient(135deg,#fff0f6,#ffe6f0)",
      intro:"Feel the romance üíï",
      questions:["Romantic Q1","Romantic Q2","Romantic Q3","Romantic Q4"],
      yesImage:"Images/romantic-yes.jpg",
      yesAudio:"Audio/romantic-yes.mp3",
      noAudio:"Audio/romantic-no.mp3"
    },
    {
      title:"Hot üî•",
      bg:"linear-gradient(135deg,#ffd6e0,#ff9ecf)",
      intro:"Things heat up üòè",
      questions:["Hot Q1","Hot Q2","Hot Q3","Hot Q4"],
      yesImage:"Images/hot-yes.jpg",
      yesAudio:"Audio/hot-yes.mp3",
      noAudio:"Audio/hot-no.mp3"
    },
    {
      title:"Spicy üå∂Ô∏è",
      bg:"linear-gradient(135deg,#ffb3c6,#ff4d6d)",
      intro:"Secret zone üòà",
      passcode:"1234",
      hint:"Something obvious ‚ù§Ô∏è",
      wrongMessage:"Nope üòú Try again",
      questions:["Spicy Q1","Spicy Q2","Spicy Q3","Spicy Q4"],
      yesImage:"Images/spicy-yes.jpg",
      yesAudio:"Audio/spicy-yes.mp3",
      noAudio:"Audio/spicy-no.mp3"
    }
  ],
  finalMessage:"You made it ‚ù§Ô∏è",
  finalImages:[
    "Images/image1.jpg",
    "Images/image2.jpg",
    "Images/image3.jpg",
    "Images/image4.jpg",
    "Images/image5.jpg"
  ],
  finalYesImage:"Images/final-yes.jpg",
  finalYesAudio:"Audio/final-yes.mp3"
};

let section=0,question=0,mode="start";
const history=[];
const screen=document.getElementById('screen');
const backBtn=document.getElementById('backBtn');

const yesBtn=document.createElement('button');
yesBtn.id='yesBtn'; yesBtn.className='primary'; yesBtn.textContent='YES üíñ';

const noBtn=document.createElement('button');
noBtn.id='noBtn'; noBtn.className='secondary'; noBtn.textContent='NO üòÖ';

function toggleDark(){document.body.classList.toggle('dark')}
function setBG(){
  if(!document.body.classList.contains('dark')){
    document.body.style.background=SITE.sections[section]?.bg||"#fff";
  }
}

function playEffect(img,audio){
  if(audio) new Audio(audio).play().catch(()=>{});
  if(img){
    const i=document.createElement('img');
    i.src=img;i.className='popup-img';
    document.body.appendChild(i);
    setTimeout(()=>i.remove(),3000);
  }
}

function save(){
  history.push({section,question,mode});
  backBtn.classList.remove('hidden');
}

backBtn.onclick=()=>{
  if(!history.length) return;
  const h=history.pop();
  section=h.section;question=h.question;mode=h.mode;
  render();
  if(!history.length) backBtn.classList.add('hidden');
};

function render(){
  setBG();
  if(mode==="start") renderStart();
  else if(mode==="intro") renderIntro();
  else if(mode==="question") renderQuestion();
  else if(mode==="password") renderPassword();
  else if(mode==="finalGallery") renderFinalGallery();
  else if(mode==="secret") renderSecret();
}

function renderStart(){
  screen.innerHTML=`
    <h1>${SITE.intro.title}</h1>
    <p>${SITE.intro.message}</p>
    <button class="primary" onclick="begin()">Start üíñ</button>
  `;
}

function begin(){save();mode="intro";render()}

function renderIntro(){
  screen.innerHTML=`
    <h1>${SITE.sections[section].title}</h1>
    <p>${SITE.sections[section].intro}</p>
    <button class="primary" onclick="startQuestions()">Continue</button>
  `;
}

function startQuestions(){
  save();
  question=0;
  mode="question";
  render();
}

function renderQuestion(){
  screen.innerHTML=`
    <h1>${SITE.sections[section].questions[question]}</h1>
    <div class="buttons"></div>
  `;
  const box=screen.querySelector('.buttons');
  box.append(yesBtn,noBtn);
  resetButtons();
  bindButtons();
}

function renderPassword(){
  const s=SITE.sections[section];
  screen.innerHTML=`
    <h1>üîê Enter Password</h1>
    <p>${s.hint}</p>
    <input id="pw" style="width:100%;padding:12px;border-radius:10px;border:1px solid #ccc">
    <p id="err" style="color:#ff4d6d"></p>
    <button class="primary" onclick="checkPw()">Unlock</button>
  `;
}

function renderFinalGallery(){
  screen.innerHTML=`
    <h1>${SITE.finalMessage}</h1>
    <div class="final-scroll" id="scrollBox">
      ${SITE.finalImages.map(i=>`<img src="${i}">`).join("")}
    </div>
    <button class="primary" style="margin-top:20px" onclick="openSecret()">
      View Secret Message üíå
    </button>
  `;
  playEffect(SITE.finalYesImage,SITE.finalYesAudio);

  const box=document.getElementById('scrollBox');
  let pause=false;
  box.addEventListener('touchstart',()=>pause=true);
  box.addEventListener('touchend',()=>pause=false);

  setInterval(()=>{
    if(!pause){
      box.scrollTop+=1;
      if(box.scrollTop+box.clientHeight>=box.scrollHeight) box.scrollTop=0;
    }
  },40);
}

function openSecret(){
  save();
  mode="secret";
  render();
}

function renderSecret(){
  let time=10;
  screen.innerHTML=`
    <h1>üí£ Secret Unlocking...</h1>
    <p id="count">${time}</p>
  `;
  const t=setInterval(()=>{
    time--;
    document.getElementById('count').textContent=time;
    if(time===0){
      clearInterval(t);
      screen.innerHTML=`
        <h1>üí• BOOM üí•</h1>
        <p>I knew you‚Äôd love this üòò</p>
      `;
    }
  },1000);
}

function bindButtons(){
  yesBtn.onclick=()=>{
    const s=SITE.sections[section];
    playEffect(s.yesImage,s.yesAudio);
    save();
    question++;
    if(question < s.questions.length){
      render(); return;
    }
    section++;
    question=0;
    if(section >= SITE.sections.length){
      mode="finalGallery";
      render(); return;
    }
    SITE.sections[section].passcode ? mode="password" : mode="intro";
    render();
  };

  noBtn.onclick=()=>{
    const s=SITE.sections[section];
    if(s.noAudio) new Audio(s.noAudio).play().catch(()=>{});
    moveNo();
  };
}

function checkPw(){
  if(document.getElementById('pw').value !== SITE.sections[section].passcode){
    document.getElementById('err').textContent=SITE.sections[section].wrongMessage;
    return;
  }
  save();
  mode="question";
  render();
}

function resetButtons(){
  yesBtn.style.transform='translate(-120%,-50%)';
  noBtn.style.transform='translate(20%,-50%)';
}

function moveNo(){
  const b=noBtn.parentElement;
  const r=60+Math.random()*40,a=Math.random()*Math.PI*2;
  noBtn.style.left=(b.clientWidth/2+r*Math.cos(a))+'px';
  noBtn.style.top=(b.clientHeight/2+r*Math.sin(a))+'px';
}

render();
</script>